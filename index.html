<!DOCTYPE html>
<html lang="zh-TW">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>DIY é›»è§£è³ªæ°´è¨ˆç®—å™¨ - æ—©å®‰å¥åº·</title>
   <style>
       :root {
           --primary-color: #78bf22;
           --secondary-color: #FAA0BE;
           --accent-color: #d2672d;
           --text-color: #333;
           --bg-color: #f9f9f9;
       }


       * {
           box-sizing: border-box;
           font-family: "PingFang TC", "Microsoft JhengHei", sans-serif;
           user-select: none; /* é˜²æ­¢æ‰‹æ©Ÿèª¤é¸æ–‡å­— */
       }


       body {
           margin: 0;
           padding: 20px 10px; /* å¢åŠ ä¸Šä¸‹é–“è·ï¼Œé˜²æ­¢è²¼é½Šè¢å¹•é‚Šç·£ */
           background-color: transparent;
           /* ç§»é™¤ flex å±…ä¸­è¨­å®šï¼Œè§£æ±ºä¸Šä¸‹å¤§é¢ç©ç•™ç™½å•é¡Œ */
           display: block; 
       }

       .widget-container {
           background: #ffffff;
           width: 100%;
           max-width: 450px;
           margin: 0 auto; /* æ°´å¹³å±…ä¸­ */
           border-radius: 20px;
           box-shadow: 0 10px 25px rgba(0,0,0,0.1);
           overflow: hidden;
           position: relative;
           border-top: 5px solid var(--primary-color);
       }


       /* Header Area */
       .header {
           padding: 20px;
           text-align: center;
           background: linear-gradient(to bottom, #fff, #fefefe);
       }


       .logo {
           height: 35px;
           margin-bottom: 10px;
           display: block;
           margin-left: auto;
           margin-right: auto;
       }


       h3 {
           color: var(--primary-color);
           margin: 0;
           font-size: 1.2rem;
           font-weight: 700;
           letter-spacing: 1px;
       }


       .subtitle {
           color: #666;
           font-size: 0.9rem;
           margin-top: 5px;
       }


       /* Visualization Area */
       .visual-area {
           height: 220px;
           background-color: #eefbfb;
           position: relative;
           display: flex;
           justify-content: center;
           align-items: flex-end;
           padding-bottom: 20px;
           overflow: hidden;
           transition: background-color 0.5s;
       }


       .visual-area.cold-mode {
           background-color: #e0f7fa;
       }


       /* Cup & Water Animation */
       .cup-wrapper {
           width: 120px;
           height: 180px;
           border: 4px solid rgba(0,0,0,0.1);
           border-top: none;
           border-radius: 0 0 20px 20px;
           position: relative;
           background: rgba(255,255,255,0.5);
           backdrop-filter: blur(2px);
           z-index: 2;
           overflow: hidden;
       }


       .water {
           position: absolute;
           bottom: 0;
           left: 0;
           width: 100%;
           height: 50%; /* Dynamic */
           background: linear-gradient(180deg, #4facfe 0%, #00f2fe 100%);
           transition: height 0.3s ease-out, background 0.5s;
           opacity: 0.8;
       }


       .visual-area.cold-mode .water {
           background: linear-gradient(180deg, #2980b9 0%, #6dd5fa 100%);
       }


       /* Wave Animation */
       .water::before, .water::after {
           content: "";
           position: absolute;
           width: 200%;
           height: 200%;
           top: -150%;
           left: -50%;
           background-color: rgba(255, 255, 255, 0.4);
           border-radius: 40%;
           animation: wave 10s linear infinite;
       }


       .water::after {
           background-color: rgba(255, 255, 255, 0.2);
           animation: wave 15s linear infinite;
           top: -160%;
       }


       @keyframes wave {
           0% { transform: rotate(0deg); }
           100% { transform: rotate(360deg); }
       }


       /* Floating Bubbles */
       .bubble {
           position: absolute;
           background: rgba(255,255,255,0.6);
           border-radius: 50%;
           bottom: 0;
           animation: bubbleUp 4s infinite ease-in-out;
       }


       @keyframes bubbleUp {
           0% { transform: translateY(0) scale(1); opacity: 0.8; }
           100% { transform: translateY(-200px) scale(1.5); opacity: 0; }
       }


       /* Controls Area */
       .controls {
           padding: 25px;
           background: #fff;
           border-radius: 20px 20px 0 0;
           margin-top: -20px;
           position: relative;
           z-index: 3;
           box-shadow: 0 -5px 15px rgba(0,0,0,0.05);
       }


       .input-group {
           margin-bottom: 20px;
       }


       .label-row {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 10px;
       }


       .label-text {
           font-weight: bold;
           color: var(--text-color);
       }


       .value-display {
           color: var(--primary-color);
           font-weight: 800;
           font-size: 1.5rem;
       }


       input[type=range] {
           width: 100%;
           -webkit-appearance: none;
           background: transparent;
       }


       input[type=range]::-webkit-slider-thumb {
           -webkit-appearance: none;
           height: 24px;
           width: 24px;
           border-radius: 50%;
           background: var(--primary-color);
           cursor: pointer;
           margin-top: -10px;
           box-shadow: 0 2px 6px rgba(120, 191, 34, 0.4);
       }


       input[type=range]::-webkit-slider-runnable-track {
           width: 100%;
           height: 4px;
           cursor: pointer;
           background: #ddd;
           border-radius: 2px;
       }


       .quick-btns {
           display: flex;
           gap: 10px;
           margin-top: 10px;
       }


       .q-btn {
           flex: 1;
           padding: 8px;
           border: 1px solid #ddd;
           background: #fff;
           border-radius: 8px;
           font-size: 0.85rem;
           color: #666;
           cursor: pointer;
           transition: all 0.2s;
       }


       .q-btn:active, .q-btn.active {
           background: var(--primary-color);
           color: white;
           border-color: var(--primary-color);
       }


       /* Result Box */
       .result-box {
           background: #fff8e1;
           border-left: 5px solid var(--accent-color);
           padding: 15px;
           border-radius: 8px;
           margin-top: 20px;
           display: flex;
           align-items: center;
           justify-content: space-between;
       }


       .result-info div:first-child {
           font-size: 0.9rem;
           color: #666;
           margin-bottom: 4px;
       }


       .salt-amount {
           font-size: 1.8rem;
           font-weight: 800;
           color: var(--accent-color);
       }


       .spoon-hint {
           background: var(--accent-color);
           color: white;
           padding: 5px 10px;
           border-radius: 20px;
           font-size: 0.8rem;
           display: flex;
           align-items: center;
           gap: 5px;
       }


       /* Temp Switch */
       .temp-switch-row {
           display: flex;
           align-items: center;
           justify-content: space-between;
           margin-top: 20px;
           padding-top: 15px;
           border-top: 1px dashed #eee;
       }


       .switch-label {
           font-size: 0.9rem;
           color: #555;
           display: flex;
           align-items: center;
           gap: 5px;
       }


       /* Toggle Switch CSS */
       .switch {
           position: relative;
           display: inline-block;
           width: 50px;
           height: 26px;
       }
       .switch input { opacity: 0; width: 0; height: 0; }
       .slider {
           position: absolute;
           cursor: pointer;
           top: 0; left: 0; right: 0; bottom: 0;
           background-color: var(--primary-color);
           transition: .4s;
           border-radius: 34px;
       }
       .slider:before {
           position: absolute;
           content: "";
           height: 20px;
           width: 20px;
           left: 3px;
           bottom: 3px;
           background-color: white;
           transition: .4s;
           border-radius: 50%;
       }
       input:checked + .slider { background-color: #2196F3; }
       input:checked + .slider:before { transform: translateX(24px); }


       /* Warning Overlay */
       .warning-overlay {
           position: absolute;
           top: 0; left: 0; right: 0; bottom: 0;
           background: rgba(33, 150, 243, 0.9);
           z-index: 10;
           display: flex;
           flex-direction: column;
           justify-content: center;
           align-items: center;
           color: white;
           opacity: 0;
           pointer-events: none;
           transition: opacity 0.3s;
           text-align: center;
           border-radius: 20px 20px 0 0; /* Match container */
       }
       .visual-area .warning-overlay {
            height: 100%;
            border-radius: 0;
       }
       .show-warning {
           opacity: 1;
           pointer-events: all;
       }
       .warning-btn {
           background: white;
           color: #2196F3;
           border: none;
           padding: 8px 20px;
           border-radius: 20px;
           margin-top: 10px;
           cursor: pointer;
           font-weight: bold;
       }


       /* Footer */
       .footer {
           background: #f1f1f1;
           padding: 10px;
           text-align: center;
           font-size: 0.75rem;
           color: #888;
       }
       .footer a {
           color: #666;
           text-decoration: none;
       }


   </style>
</head>
<body>


<div class="widget-container">
   <div class="header">
       <img src="https://edh.tw/_ipx/w_286/images/logo-edh.png" alt="æ—©å®‰å¥åº·" class="logo">
       <h3>DIY é›»è§£è³ªæ°´è¨ˆç®—å™¨</h3>
       <p class="subtitle">è¼¸å…¥æ°´é‡ï¼Œè‡ªå‹•æ›ç®—é£Ÿé¹½é»ƒé‡‘æ¯”ä¾‹</p>
   </div>


   <!-- Animation Area -->
   <div class="visual-area" id="visualArea">
       <!-- Bubbles for effect -->
       <div class="bubble" style="left: 20%; width: 10px; height: 10px; animation-duration: 3s;"></div>
       <div class="bubble" style="left: 70%; width: 15px; height: 15px; animation-duration: 5s;"></div>
      
       <div class="cup-wrapper">
           <div class="water" id="waterLevel"></div>
       </div>


       <!-- Ice Water Warning -->
       <div class="warning-overlay" id="warningOverlay">
           <div style="font-size: 3rem;">ğŸ¥¶</div>
           <div style="font-weight: bold; margin: 10px 0;">å¤ªå†°äº†ï¼è…¸èƒƒæœƒå—å‚·</div>
           <div style="font-size: 0.9rem; padding: 0 20px;">è«‹æ”¾ç½®å›æº«æˆ–ç”¨æº«æ°´èª¿é…ï¼Œ<br>é¿å…åˆºæ¿€ç—™æ”£çš„èƒƒéƒ¨ã€‚</div>
           <button class="warning-btn" onclick="toggleTemp(false)">æˆ‘çŸ¥é“äº†ï¼Œæ”¹å›å¸¸æº«</button>
       </div>
   </div>


   <div class="controls">
       <!-- Input Section -->
       <div class="input-group">
           <div class="label-row">
               <span class="label-text">ğŸ’§ æº–å‚™æ°´é‡</span>
               <span class="value-display"><span id="volDisplay">1000</span><span style="font-size:1rem; margin-left:2px;">ml</span></span>
           </div>
           <input type="range" min="100" max="2000" step="50" value="1000" id="volInput">
          
           <div class="quick-btns">
               <button class="q-btn" onclick="setVolume(300)">é¦¬å…‹æ¯ (300)</button>
               <button class="q-btn" onclick="setVolume(600)">å¯¶ç‰¹ç“¶ (600)</button>
               <button class="q-btn active" onclick="setVolume(1000)">å¤§æ°´å£º (1000)</button>
           </div>
       </div>


       <!-- Result Section -->
       <div class="result-box">
           <div class="result-info">
               <div>éœ€è¦åŠ å…¥é£Ÿé¹½</div>
               <div class="salt-amount"><span id="saltDisplay">10</span><span style="font-size:1rem;">g</span></div>
           </div>
           <div class="spoon-hint">
               <span>ğŸ¥„</span> ç´„ <span id="spoonDisplay">2</span> èŒ¶åŒ™
           </div>
       </div>


       <!-- Temp Switch -->
       <div class="temp-switch-row">
           <div class="switch-label">
               <span>ğŸŒ¡ï¸ æ°´æº«æª¢æŸ¥</span>
               <span style="font-size: 0.8rem; color: #999;">(è«‹å‹¿ä½¿ç”¨å†°æ°´)</span>
           </div>
           <label class="switch">
               <input type="checkbox" id="tempToggle" onchange="toggleTemp(this.checked)">
               <span class="slider"></span>
           </label>
       </div>
   </div>


   <div class="footer">
       Â© æ—©å®‰å¥åº·å…§å®¹éƒ¨é–‹ç™¼ | <a href="https://edh.tw/" target="_blank">æ›´å¤šå¥åº·è³‡è¨Š</a>
   </div>
</div>


<script>
   const volInput = document.getElementById('volInput');
   const volDisplay = document.getElementById('volDisplay');
   const saltDisplay = document.getElementById('saltDisplay');
   const spoonDisplay = document.getElementById('spoonDisplay');
   const waterLevel = document.getElementById('waterLevel');
   const btns = document.querySelectorAll('.q-btn');
   const visualArea = document.getElementById('visualArea');
   const warningOverlay = document.getElementById('warningOverlay');
   const tempToggle = document.getElementById('tempToggle');


   // Formula: 10g salt per 1000ml water
   // 1 teaspoon approx 5g salt
   function updateCalc() {
       const vol = parseInt(volInput.value);
      
       // Update Text
       volDisplay.innerText = vol;
      
       // Calculate Salt
       const salt = (vol / 1000) * 10;
       // Fix to 1 decimal if needed, but 0.5 steps usually fine. Let's keep it clean.
       // If it's a whole number, show whole, else 1 decimal.
       saltDisplay.innerText = Number.isInteger(salt) ? salt : salt.toFixed(1);


       // Calculate Spoons (Approx)
       const spoons = (salt / 5);
       spoonDisplay.innerText = Number.isInteger(spoons) ? spoons : spoons.toFixed(1);


       // Update Animation
       // Map 100ml-2000ml to 10%-95% height
       const minHeight = 10;
       const maxHeight = 95;
       const percentage = ((vol - 100) / (2000 - 100)) * (maxHeight - minHeight) + minHeight;
       waterLevel.style.height = percentage + '%';


       // Update Buttons State
       btns.forEach(btn => {
           btn.classList.remove('active');
           if(btn.innerText.includes(vol)) {
               btn.classList.add('active');
           }
       });
   }


   function setVolume(val) {
       volInput.value = val;
       updateCalc();
   }


   function toggleTemp(isIce) {
       // Sync checkbox if function called via button
       tempToggle.checked = isIce;


       if (isIce) {
           visualArea.classList.add('cold-mode');
           warningOverlay.classList.add('show-warning');
       } else {
           visualArea.classList.remove('cold-mode');
           warningOverlay.classList.remove('show-warning');
       }
   }


   // Listeners
   volInput.addEventListener('input', updateCalc);
  
   // Init
   updateCalc();


</script>


</body>
</html>
